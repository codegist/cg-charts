<link href="../polymer/polymer.html" rel="import">
<link href="../paper-shadow/paper-shadow.html" rel="import">

<script src="../Chart.js/Chart.js"></script>

<polymer-element name="cg-charts-base" attributes="data header width height">
<template>
  <style>
    :host {
      font-family: sans-serif;
    }
    #chart{
      margin:30px;
    }
    #header span {
      font-size: 1.3em;
    }
    #legend paper-shadow {
      border-radius: 5px;
    }
    #legend {
        max-width:{{width}}px;
    }
    #legend .item{
      margin:5px;
      padding:5px;
      min-width:75px;
    }
    #legend .item .label{
      z-index:1;
      text-align: center;
      color:white
    }
  </style>
  <div layout vertical center>
    <template if="{{header}}">
      <div id="header">
        <span>{{header}}</span>
      </div>
    </template>
    <canvas id="chart" width="{{width}}" height={{height}}"></canvas>
    <div id="legend" layout horizontal wrap>
      <template repeat="{{(chart.segments || chart.datasets)  as data}}">
          <div relative class="item" layout horizontal center>
            <paper-shadow z="2" fit style="background-color:{{data.fillColor}}"></paper-shadow>
            <div flex class="label">{{data.label}}</div>
          </div>
      </template>
    </div>
  </div>
</template>
<script>

  Polymer("cg-charts-base", {
      header:null,
      width:400,
      height:400,
      data:null,
      chart:null,
      options:{},
      ready:function(){
//        Chart.defaults.global.responsive = true;
      },
      domReady:function(){
        this.ctx = this.$.chart.getContext("2d");
        this.dataChanged();
      },
      dataChanged:function(){
        if(!this.ctx) {
          return;
        }
        this.chart = this.createChart(this.ctx, this.data, this.options);
      },
      createChart:function(context, options, data){
        throw "to override";
      }
  });

</script>
</polymer-element>